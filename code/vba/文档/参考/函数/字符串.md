# 字符串

- [字符串](#字符串)
  - [InStr()](#instr)
    - [判断空字符串](#判断空字符串)
  - [InStrB()](#instrb)
  - [LTrim、RTrim 和 Trim 函数](#ltrimrtrim-和-trim-函数)
  - [Right 函数](#right-函数)
  - [Left 函数](#left-函数)
  - [Split 函数](#split-函数)
  - [StrComp 函数](#strcomp-函数)
  - [LCase 函数](#lcase-函数)
  - [UCase 函数](#ucase-函数)
  - [Replace 函数](#replace-函数)
  - [Mid 函数](#mid-函数)

## InStr()

返回一个 Variant (Long) 值，指定**一个字符串在另一个字符串中首次出现的位置**。

语法：

`InStr([ start ], string1, string2, [ compare ])`

`InStr` 函数语法有以下参数：

|Part|说明|
|--|--|
|start|可选。 设置每次搜索的起始位置的数字表达式。 如果忽略，则搜索从第一个字符位置开始。 如果 `start` 包含 `Null` ，则出现错误。 **如果指定了 `compare` ，则 `start` 参数是必需的**。<br><br> 默认为1|
|string1|必需。 要搜索的字符串表达式。|
|string2|必需。 搜索到的字符串表达式。|
|compare|可选。 指定字符串比较的类型。 如果 compare 为 Null，则会发生错误。 如果省略 compare，则 Option Compare 设置将决定比较的类型。 指定有效的 LCID (LocaleID) 以在比较中使用区域设置特定规则。|

设置：

`compare` 参数设置如下。

|常量|值|说明|
|--|--|--|
|vbUseCompareOption|-1|使用 Option Compare 语句的设置执行比较。|
|vbBinaryCompare|0|执行二进制比较。（**默认比较方式**）|
|vbTextCompare|1|执行文本比较。|
|vbDatabaseCompare|2|仅用于 Microsoft Access。 根据数据库中的信息执行比较。|

返回值：

|If| InStr 返回|
|--|--|
|string1| 是零长度 0|
|string1 为 Null| NULL|
|string2 是零长度| start|
|string2 为 Null| NULL|
|未找到 string2| 0|
|在 string1 中找到 string2| 找到匹配的位置|
|start>string2| 0|

例子：

```vb
Dim SearchString, SearchChar, MyPos
SearchString ="XXpXXpXXPXXP"    ' String to search in.
SearchChar = "P"    ' Search for "P".

' A textual comparison starting at position 4. Returns 6.
MyPos = Instr(4, SearchString, SearchChar, 1)    

' A binary comparison starting at position 1. Returns 9.
MyPos = Instr(1, SearchString, SearchChar, 0)

' Comparison is binary by default (last argument is omitted).
MyPos = Instr(SearchString, SearchChar)    ' Returns 9.

MyPos = Instr(1, SearchString, "W")    ' Returns 0.
```

### 判断空字符串

- string2 为空字符串，所以返回的值取决于 start。
  - 如果 string1 为空字符串，那么会返回 0
  - 如果 string1 不为空字符串，那么会返回 start （不等于0）

```vb
Dim compareStr As String, pos As Integer
compareStr = ""

pos = InStr(compareStr, "")
If pos <> 0 Then
    MsgBox "不为空字符串"
Else
    MsgBox "为空字符串"
End If
```

## InStrB()

`InStrB` 函数适用于包含在字符串中的**字节数据**。 `InStrB` 返回某字符串在其他字符串中首次出现的字节位置，而不返回其字符位置。

## LTrim、RTrim 和 Trim 函数

返回“变量” （“字符串”）包含指定字符串副本（不含前导空格 (LTrim)、后续空格 (RTrim) 或前导和后续空格 (Trim)）。

```vb
Dim MyString, TrimString
MyString = "  <-Trim->  "    ' Initialize string.
TrimString = LTrim(MyString)    ' TrimString = "<-Trim->  ".
TrimString = RTrim(MyString)    ' TrimString = "  <-Trim->".
TrimString = LTrim(RTrim(MyString))    ' TrimString = "<-Trim->".
' Using the Trim function alone achieves the same result.
TrimString = Trim(MyString)    ' TrimString = "<-Trim->".
```

## Right 函数

返回了从字符串的右边开始包含特定数目的字符的“变量”（“字符串”）。

语法：

`Right(string, length)`

- string
  - 必需。
  - 字符串表达式，从中返回最右边的字符。 如果字符串包含 Null，则返回 Null。
- Length
  - 必需；Variant (Long)。
  - **数值表达式指示要返回多少字符**。 如果为 0，则返回零长度字符串 ("")。 如果大于或等于“字符串” 中的字符数量，则返回整个字符串。

```vb
Dim AnyString, MyStr
AnyString = "Hello World"      ' Define string.
MyStr = Right(AnyString, 1)    ' Returns "d".
MyStr = Right(AnyString, 6)    ' Returns " World".
MyStr = Right(AnyString, 20)   ' Returns "Hello World".
```

## Left 函数

同 `Right` 函数，只不过从左边开始

可以用来获取字符串的前几位

应用：截取字符串：`Result = Left(Result, Len(Result) - number)`

## Split 函数

返回包含指定数目的子字符串的从零开始的一维数组。

```vb
Dim strFull As String
Dim arrSplitStrings1() As String

strFull = "Dow - Fonseca - Graham - Kopke - Noval - Offley - Sandeman - Taylor - Warre"    ' String that will be used. 

arrSplitStrings1 = Split(strFull, "-")      ' arrSplitStrings1 will be an array from 0 To 8. 
```

## StrComp 函数

返回指示字符串比较的结果(Integer)

语法：

`StrComp (string1， string2， [ compare ])`

`compare` 参数设置为：

- vbUseCompareOption：-1 。使用 Option Compare 语句的设置来执行比较。
- vbBinaryCompare：0 。执行二进制比较。
- vbTextCompare：1 。执行文本比较。
- vbDatabaseCompare：2

`StrComp` 函数包含以下返回值：

- string1 小于 string2：-1
- string1 等于 string2：0
- string1 大于 string2：1
- string1 或 string2 为 Null：Null

```vb
Dim MyStr1, MyStr2, MyComp
MyStr1 = "ABCD": MyStr2 = "abcd"    ' Define variables.
MyComp = StrComp(MyStr1, MyStr2, 1)    ' Returns 0.
MyComp = StrComp(MyStr1, MyStr2, 0)    ' Returns -1.
MyComp = StrComp(MyStr2, MyStr1)    ' Returns 1.
```

## LCase 函数

返回已转换为小写形式的 String。

```vb
Dim UpperCase, LowerCase
Uppercase = "Hello World 1234"    ' String to convert.
Lowercase = LCase(UpperCase)    ' Returns "hello world 1234".
```

## UCase 函数

返回已转换为大写形式的 String。

```vb
Dim LowerCase, UpperCase
LowerCase = "Hello World 1234"    ' String to convert.
UpperCase = UCase(LowerCase)    ' Returns "HELLO WORLD 1234".
```

## Replace 函数

`Replace` 函数的返回值是一个字符串，其中进行了替换，该字符串从 start 指定的位置开始，并在表达式字符串末尾结束。 它不是从头到尾的原始字符串的副本。

语法：`Replace(expression, find, replace, [ start, [ count, [ compare ]]])`

- expression
  - 必填。
  - 包含要替换的子字符串的字符串表达式。
- find
  - 必填。
  - 要搜索的子字符串。
- replace
  - 必填。
  - 替换子字符串。
- start
  - 可选。
  - 要搜索和返回的 表达式 的子字符串的起始位置。 如果省略，则假定此值为 1。
- count
  - 可选。
  - 要执行子字符串替换的次数。 如果省略，则默认值为 -1，这意味着，进行所有可能的替换。
- compare
  - 可选。
  - 指示计算子字符串时要使用的比较类别的数值。 请参阅“设置”部分以了解各个值。

## Mid 函数

返回一个 Variant (String)，其中包含字符串中的指定数量的字符。

语法：`Mid(string, start, [ length ])`

Mid 函数语法包含以下命名参数：

- string
  - 必需。
  - 从中返回字符的字符串表达式。 如果字符串包含 Null，则返回 Null。
- start
  - 必需，Long。
  - 字符串中被视为开始部分的字符位置。 如果 start 大于字符串中的字符数，则 Mid 返回零长度字符串 ("")。
- Length
  - 可选；Variant (Long)。
  - 要返回的字符的数目。 如果省略此部分或此部分中的数目少于文本中的 length 字符数（包括 start 处的字符），则将返回从 start 位置到字符串末尾的所有字符。

```vb
Dim MyString, FirstWord, LastWord, MidWords
MyString = "Mid Function Demo"    ' Create text string.
FirstWord = Mid(MyString, 1, 3)    ' Returns "Mid".
LastWord = Mid(MyString, 14, 4)    ' Returns "Demo".
MidWords = Mid(MyString, 5)    ' Returns "Function Demo".
```

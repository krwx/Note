# 文件

- [文件](#文件)
  - [Dir](#dir)

## Dir

返回一个 String，它表示与指定模式或文件属性或驱动器的卷标匹配的文件、目录或文件夹的名称。

语法：`Dir [(pathname, [attributes])]`

Dir 函数语法具有以下部分：

- pathname
  - 可选。
  - 指定文件名的字符串表达式，可包括目录或文件夹和驱动器。
  - 如果未找到 pathname，则返回零长度字符串 ("")。
- attributes
  - 可选。
  - 其和指定文件属性的常量或数值表达式。 如果省略它，则返回与 pathname 匹配但没有属性的文件。

`attributes` 参数设置包括：

|常量| 值| 说明|
|--|--|--|
|vbNormal| 0 |（默认）指定没有属性的文件。|
|vbReadOnly| 1 |指定只读文件以及不带属性的文件。|
|vbHidden| 2 |指定隐藏文件以及不带属性的文件。|
|vbSystem| 4 |指定系统文件以及不带属性的文件。 在 Macintosh 上不可用。|
|bVolume| 8 |指定卷标；如果指定任何其他属性，则忽略 vbVolume。 在 Macintosh 上不可用。|
|vbDirectory| 16 |指定目录或文件夹以及不带属性的文件。|
|vbAlias| 64 |指定文件名为别名。 仅在 Macintosh 上可用。|

- Dir 支持使用多字符 (*) 和单字符 (？) 通配符来指定多个文件。

- 必须在首次调用 Dir 函数时指定 pathname，否则将发生错误。 如果还指定文件属性，则必须包括 pathname。

- Dir 返回与 pathname 匹配的第一个文件名。
- 若要获取与 pathname 匹配的任何其他文件名，请重新调用 Dir 而不使用参数。
- 当不再有匹配的文件名时，Dir 将返回零长度字符串 ("")。 在返回零长度字符串后，必须在后续调用中指定 pathname，否则将发生错误。

- 不能以递归方式调用 Dir 函数。
- 调用带 `vbDirectory` 属性的 Dir 不会连续返回子目录。

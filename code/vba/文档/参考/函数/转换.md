# 转换

- [转换](#转换)
  - [转换函数](#转换函数)
    - [ChrW 函数](#chrw-函数)
    - [Val 函数](#val-函数)
  - [类型转换](#类型转换)
    - [CStr](#cstr)
    - [CDate](#cdate)

## 转换函数

### ChrW 函数

`ChrW(charcode)`

返回一个字符串，其中包含与指定的字符代码关联的字符。

> ChrW 函数返回包含 Unicode 字符的字符串，但对不支持 Unicode 的平台例外，这种情况下的行为与 Chr 函数相同。

```vb
Dim MyChar
MyChar = Chr(65)    ' Returns A.
MyChar = Chr(97)    ' Returns a.
MyChar = Chr(62)    ' Returns >.
MyChar = Chr(37)    ' Returns %.
```

### Val 函数

以适当类型的数值格式 **返回字符串中包含的数字**。

Val 函数在无法识别为数字的一部分的第一个字符处停止读取字符串。

该函数识别基数前缀 `&O`（表示八进制）和 `&H`（表示十六进制）。空白、制表符和换行符将从参数中删除。

```vb
Val("    1615 198th Street N.E.") ' 1615198
Val("&HFFFF") ' -1。识别成十六进制

Dim MyValue
MyValue = Val("2457")    ' Returns 2457.
MyValue = Val(" 2 45 7")    ' Returns 2457.
MyValue = Val("24 and 57")    ' Returns 24.
```

## 类型转换

|功能| 返回类型| 表达式参数的范围|
|--|--|--|
|CBool| Boolean| 任何有效的“字符串”或数值型表达式。|
|CByte| Byte| 0 到 255.|
|CCur| Currency| -922,337,203,685,477.5808 到 922,337,203,685,477.5807。|
|CDate| Date| 任何有效的日期表达式。|
|CDbl| Double| 负值为 -1.79769313486231E308 到 -4.94065645841247E-324；正值为 4.94065645841247E-324 到 1.79769313486232E308。|
|CDec| Decimal| 零缩放数（即数字中没有小数位）为 79,228,162,514,264,337,593,543,950,335。 有 28 个小数位的数字的范围为 7.9228162514264337593543950335。 最小的非零数字为 0.0000000000000000000000000001。|
|CInt| Integer| -32,768 到 32,767；分数四舍五入。|
|CLng| Long| -2,147,483,648 到 2,147,483,647；分数四舍五入。|
|CLngLng| LongLong| -9,223,372,036,854,775,808 至 9,223,372,036,854,775,807，分数四舍五入。 （仅在 64 位平台上有效。）|
|CLngPtr| LongPtr| 32 位系统上为 -2,147,483,648 到 2,147,483,647，64 位系统上为 -9,223,372,036,854,775,808 到 9,223,372,036,854,775,807；32 位系统和 64 位系统分数都四舍五入。|
|CSng| Single| 负值为 -3.402823E38 到 -1.401298E-45；正值为 1.401298E-45 到 3.402823E38。|
|CStr| String| CStr 的返回值取决于 expression 参数。 请参阅下表。|
|CVar| Variant| 和“Double”针对数值型的范围相同。 和“字符串”针对非数值型的范围相同。|

### CStr

```vb
Dim MyDouble, MyString 
MyDouble = 437.324 ' MyDouble is a Double. 
MyString = CStr(MyDouble) ' MyString contains "437.324".
```

### CDate

```vb
Dim MyDate, MyShortDate, MyTime, MyShortTime 
MyDate = "February 12, 1969" ' Define date. 
MyShortDate = CDate(MyDate) ' Convert to Date data type. 
 
MyTime = "4:35:47 PM" ' Define time. 
MyShortTime = CDate(MyTime) ' Convert to Date data type.
```

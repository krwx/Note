# 数组扁平化

- [数组扁平化](#数组扁平化)
  - [1. **使用 `flat()` 方法（ES2019）**](#1-使用-flat-方法es2019)
  - [2. **使用递归**](#2-使用递归)
  - [3. **使用 `reduce()`**](#3-使用-reduce)
    - [**带深度的扁平化函数**](#带深度的扁平化函数)
  - [4. **使用 `while` 循环 + 栈（非递归）**](#4-使用-while-循环--栈非递归)
  - [5. **使用扩展运算符(...) + `some()`**](#5-使用扩展运算符--some)

JavaScript 数组扁平化有多种实现方式，以下是常见的几种方法：

## 1. **使用 `flat()` 方法（ES2019）**

```javascript
const arr = [1, [2, [3, [4]]]];

// 默认只展开一层
console.log(arr.flat()); // [1, 2, [3, [4]]]

// 展开两层
console.log(arr.flat(2)); // [1, 2, 3, [4]]

// 完全展开（Infinity）
console.log(arr.flat(Infinity)); // [1, 2, 3, 4]
```

## 2. **使用递归**

```javascript
function flatten(arr) {
    let result = [];
    
    for (let item of arr) {
        if (Array.isArray(item)) {
            result = result.concat(flatten(item));
        } else {
            result.push(item);
        }
    }
    
    return result;
}

const arr = [1, [2, [3, [4]]]];
console.log(flatten(arr)); // [1, 2, 3, 4]
```

## 3. **使用 `reduce()`**

```javascript
function flatten(arr) {
    return arr.reduce((prev, curr) => {
        return prev.concat(Array.isArray(curr) ? flatten(curr) : curr);
    }, []);
}

const arr = [1, [2, [3, [4]]]];
console.log(flatten(arr)); // [1, 2, 3, 4]
```

### **带深度的扁平化函数**

```javascript
function flatten(arr, depth = Infinity) {
    if (depth === 0) return arr.slice();
    
    return arr.reduce((prev, curr) => {
        if (Array.isArray(curr) && depth > 0) {
            return prev.concat(flatten(curr, depth - 1));
        }
        return prev.concat(curr);
    }, []);
}

const arr = [1, [2, [3, [4]]]];
console.log(flatten(arr, 2)); // [1, 2, 3, [4]]
```

## 4. **使用 `while` 循环 + 栈（非递归）**

```javascript
function flatten(arr) {
    const stack = [...arr];
    const result = [];
    
    while (stack.length) {
        const next = stack.pop();
        if (Array.isArray(next)) {
            stack.push(...next);
        } else {
            result.push(next);
        }
    }
    
    return result.reverse(); // 保持原顺序
}

const arr = [1, [2, [3, [4]]]];
console.log(flatten(arr)); // [1, 2, 3, 4]
```

## 5. **使用扩展运算符(...) + `some()`**

```javascript
function flatten(arr) {
    while (arr.some(item => Array.isArray(item))) {
        arr = [].concat(...arr);
    }
    return arr;
}

const arr = [1, [2, [3, [4]]]];
console.log(flatten(arr)); // [1, 2, 3, 4]
```

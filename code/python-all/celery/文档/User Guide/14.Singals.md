# Signals

## 介绍

## Logging Signals

### setup_logging

如果连接了此信号， Celery 将不会配置 logger ，因此您可以使用此信号完全覆盖您自己的日志配置。

如果您想增强 Celery 的日志配置设置，则可以使用 `after_setup_logger` 和 `after_seetup_task_logger` 信号。

Provides arguments:

- loglevel
  - The level of the logging object.
- logfile
  - The name of the logfile.
- format
  - The log format string.
- colorize
  - Specify if log messages are colored or not.

### after_setup_logger

在设置每个全局 logger（不是 task loggers ）后发送。用于增强日志记录配置。

Provides arguments:

- loglevel
  - The level of the logging object.
- logfile
  - The name of the logfile.
- format
  - The log format string.
- colorize
  - Specify if log messages are colored or not.

```py
import logging
from celery.signals import after_setup_logger

@after_setup_logger.connect
def setup_logger(logger, *args, **kwargs):
    # 为 worker 日志添加处理器
    formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')
    handler = logging.FileHandler('/var/log/celery/worker.log')
    handler.setFormatter(formatter)
    logger.addHandler(handler)
```

### after_setup_task_logger

在设置每个 task logger 后发送。用于增强日志记录配置。

Provides arguments:

- loglevel
  - The level of the logging object.
- logfile
  - The name of the logfile.
- format
  - The log format string.
- colorize
  - Specify if log messages are colored or not.

```py
import logging
from celery.signals import after_setup_task_logger

@after_setup_task_logger.connect
def setup_task_logger(logger, *args, **kwargs):
    # 为任务日志添加处理器
    formatter = logging.Formatter('%(asctime)s - %(task_id)s - %(task_name)s - %(levelname)s - %(message)s')
    handler = logging.FileHandler('/var/log/celery/tasks.log')
    handler.setFormatter(formatter)
    logger.addHandler(handler)
```

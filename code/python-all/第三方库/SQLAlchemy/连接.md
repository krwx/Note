# 连接

- [连接](#连接)
  - [SQL Server](#sql-server)
    - [检查是否安装了驱动](#检查是否安装了驱动)

## SQL Server

首先要先安装 SQL Server，确保安装了 `ODBC Driver 17 for SQL Server` 驱动

1、安装 `pyodbc`

```sh
conda install pyodbc
```

2、编写连接字符串并测试

```py
from sqlalchemy import create_engine

# 连接字符串格式
server = "localhost"  # 服务器地址（如：192.168.1.100, 或实例名 MSSQLSERVER）
database = "YourDatabase"
username = "YourUsername"
password = "YourPassword"
driver = "ODBC Driver 17 for SQL Server"  # 根据实际安装的驱动版本调整

# 构建连接字符串
connection_string = (
    f"mssql+pyodbc://{username}:{password}@{server}/{database}?"
    f"driver={driver.replace(' ', '+')}"
)

# 创建引擎
engine = create_engine(connection_string)

# 测试是否连接成功
try:
    with engine.connect() as conn:
        print("连接成功！")
except Exception as e:
    print(f"连接失败：{e}")
```

注意：

- 默认端口为 `1433`，如果自定义了端口，需在服务器地址后添加 ,端口号（如 `server="localhost,1234"`）。

### 检查是否安装了驱动

windows 系统：

1. 打开 `ODBC` 数据源管理器：
   1. 按 `Win + R`，输入 `odbcad32.exe`，回车。
2. 切换到 “驱动程序” 选项卡：
   1. 查看列表中是否包含以下名称的驱动：
      1. `ODBC Driver 17 for SQL Server`
      2. `ODBC Driver 18 for SQL Server`

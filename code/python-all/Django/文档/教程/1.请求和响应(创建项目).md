# 请求和响应

- [请求和响应](#请求和响应)
  - [创建项目](#创建项目)
  - [运行](#运行)
  - [创建应用](#创建应用)
  - [编写视图](#编写视图)

## 创建项目

新建一个文件夹：

```bat
mkdir djangotutorial
```

在文件夹新建 `environment.yml` ，创建 conda 环境，安装 python 和 django

```sh
conda install python django
```

> 本地跑是不用把项目部署到 WSGI 上面，可以直接跑的，但是在生产环境要部署到 WSGI 上面，所以还是要安装 mod-wsgi

不用 cd 进文件夹，输入下面的命令创建项目：

- mysite 是项目的名称
- djangotutorial 是项目所在的文件夹

```bat
django-admin startproject mysite djangotutorial
```

文件目录如下：

```txt
djangotutorial/
    manage.py
    mysite/
        __init__.py
        settings.py
        urls.py
        asgi.py
        wsgi.py
```

- `manage.py`: 一个让你用各种方式管理 Django 项目的命令行工具。
- `mysite/`: 项目的实际 Python 包
- `mysite/__init__.py`：一个空文件，告诉 Python 这个目录应该被认为是一个 Python 包。
- `mysite/settings.py`：Django 项目的配置文件。
- `mysite/urls.py`：Django 项目的 URL 声明
- `mysite/asgi.py`：作为你的项目的运行在 `ASGI` 兼容的 Web 服务器上的入口。
- `mysite/wsgi.py`：作为你的项目的运行在 `WSGI` 兼容的Web服务器上的入口。

## 运行

启动 Django 开发服务器，这是一个用纯 Python 编写的轻量级网络服务器，会热加载

```bat
python manage.py runserver
```

## 创建应用

在 Django 中，每一个应用都是一个 Python 包，并且遵循着相同的约定。Django 自带一个工具，可以帮你生成应用的基础目录结构

> 项目和应用有什么区别？
>
> - 应用是一个专门做某件事的网络应用程序——比如博客系统，或者公共记录的数据库，或者小型的投票程序。
> - 项目则是一个网站使用的配置和应用的集合。
> - 项目可以包含很多个应用。应用可以被很多个项目使用。

处于 `manage.py` 所在的目录下，然后运行下面的命令来创建一个应用：

```bat
python manage.py startapp polls
```

这将创建一个名为 polls 的目录，其布局如下：

```txt
polls/
    __init__.py
    admin.py
    apps.py
    migrations/
        __init__.py
    models.py
    tests.py
    views.py
```

## 编写视图

`polls/views.py`

```py
from django.http import HttpResponse


def index(request):
    return HttpResponse("Hello, world. You're at the polls index.")
```

要为 polls 应用定义一个 URLconf，创建一个名为 `polls/urls.py` 的文件，并包含以下内容：

```py
from django.urls import path

from . import views

urlpatterns = [
    path("", views.index, name="index"),
]
```

在 `mysite` 项目中配置全局 `URLconf`，以包含在 `polls.urls` 中定义的 `URLconf`。为此，在 `mysite/urls.py` 中添加对 `django.urls.include` 的导入，并在 `urlpatterns` 列表中插入一个 `include()`：

```py
from django.contrib import admin
from django.urls import include, path

urlpatterns = [
    path("polls/", include("polls.urls")),
    path("admin/", admin.site.urls),
]
```

- `path()` 函数至少需要两个参数： `route` 和 `view` 。
- `include()` 函数允许引用其他 `url` 配置文件。

访问 <http://localhost:8000/polls/> ，查看是否有结果

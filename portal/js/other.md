# script 标签的 async 和 defer 属性
- defer 属性
  - 会让脚本的加载与文档的解析同步解析，然后在文档解析完成后再执行这个脚本文件。脚本最后顺序执行
- async 属性
  - 会使脚本异步加载，不会阻塞页面的解析过程，但是当脚本加载完成后立即执行 js 脚本。  
  - 多个脚本的执行顺序没有规律，取决于脚本的加载速度。

比较：
- 相同点
  - 加载时不阻塞解析 HTML 
- 不同点
  - defer 是等文档解析后再执行，async 是等脚本加载后就执行，有可能在文档解析中执行，也可能在文档解析后执行。
  - 有可能 async 的先执行，也可能 defer 的先执行，取决于 async 加载脚本完成时是在文档解析前还是解析后

脚本调用策略小结：
- async 和 defer 都指示浏览器在一个单独的线程中下载脚本，而页面的其他部分（DOM 等）正在下载，因此在获取过程中页面加载不会被阻塞。
- async 属性的脚本将在下载完成后立即执行。这将阻塞页面，并不保证任何特定的执行顺序。
- 带有 defer 属性的脚本将按照它们的顺序加载，并且只有在所有脚本加载完毕后才会执行。
- 如果脚本无需等待页面解析，且无依赖独立运行，那么应使用 async。
- 如果脚本需要等待页面解析，且依赖于其他脚本，调用这些脚本时应使用 defer，将关联的脚本按所需顺序置于 HTML 的相应 `<script>` 元素中。

## 延迟加载 js 脚本的方法：
1. 将 js 脚本放在文档的底部，来使 js 脚本尽可能的在最后来加载执行
2. 给 js 脚本添加 defer 属性
3. 给 js 脚本添加 async 属性
4. 动态创建 DOM 标签的方式，我们可以对文档的加载事件进行监听，当文档加载完成后再动态的创建 script 标签来引入 js 脚本

## 遇到 script 标签为什么会阻塞
JavaScript是单线程，在JavaScript运行时其他的事情不能被浏览器处理。事实上，大多数浏览器使用单线程处理UI更新和JavaScript运行等多个任务，而同一时间只能有一个任务被执行。所以在执行JavaScript时，会妨碍其他页面动作。

并且，html解析过程是至上而下的，当html解析器遇到诸如`<script>、<link>`等标签时，就会去下载相应内容。且加载、解析、执行JavaScript会阻止解析器往下执行。

为什么浏览器遇到 script 标签，解析完脚本后会立即执行？:  
>当浏览器遇到一个`<script>`标签时，脚本可能在运行过程中修改页面内容，所以浏览器无法预知 JavaScript 是否会修改页面内容。因此，浏览器停下来，运行此 JavaScript 代码，